<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vamos Escalar Juntos — Guia</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Poppins:wght@700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0B0C10;
      --surface:rgba(255,255,255,.04);
      --card:rgba(255,255,255,.03);
      --border:rgba(255,255,255,.12);
      --border-strong:rgba(255,255,255,.24);
      --purple:#7269E3;
      --purple-strong:#625BD6;
      --mint:#98DEA3;
      --mauve:#A783A6;
      --text:#ffffff;
      --muted:rgba(214,218,229,.85);
      --radius:16px;
      --shadow:0 10px 30px rgba(0,0,0,.5);
      --input-bg:rgba(255,255,255,.05);
      --input-bg-hover:rgba(255,255,255,.08);
      --input-bg-focus:rgba(114,105,227,.10);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:Inter, sans-serif;
      display:block;
      padding:40px 16px;
    }
    .card{
      border:1px solid var(--border);
      border-radius:20px;
      box-shadow:var(--shadow);
      padding:28px;
      max-width:860px;
      width:100%;
      background:none;
      margin:40px auto;
    }
    .title{
      font-family:Poppins, sans-serif;
      font-weight:700;
      font-size:28px;
      margin:0 0 6px;
      text-align:center;
      color:var(--mint);
    }
    .subtitle{
      margin:0 0 20px;
      color:var(--muted);
      font-size:14px;
      text-align:center;
    }
    .grid{display:grid; gap:14px}
    .grid-2{grid-template-columns:1fr 1fr}
    @media(max-width:720px){
      .grid-2{grid-template-columns:1fr}
      h3{text-align:center}
    }
    .field{display:grid; gap:8px}
    .input, textarea{
      background:var(--input-bg);
      border:1px solid var(--border);
      border-radius:12px;
      padding:12px 14px;
      font-size:14px;
      color:var(--text);
      transition:.15s ease;
      width:100%;
    }
    textarea{
      min-height:120px;
      resize:vertical;
      margin-top:20px;
    }
    .input:focus, textarea:focus{
      border-color:var(--purple);
      background:var(--input-bg-focus);
      box-shadow:0 0 0 3px rgba(114,105,227,.25);
      outline:none;
    }
    .choice{display:flex; align-items:center; gap:10px; padding:10px 12px; border:1px solid var(--border); background:var(--surface); border-radius:12px}
    .choice input{width:16px; height:16px; accent-color:var(--purple)}
    .btn{
      margin-top:16px;
      background:linear-gradient(180deg, var(--purple), var(--purple-strong));
      color:#fff;
      font-weight:700;
      border:none;
      border-radius:999px;
      padding:12px 18px;
      cursor:pointer;
      display:block;
      margin-left:auto;
      margin-right:auto;
    }
    .btn[disabled]{opacity:.6; cursor:not-allowed}
    #otherField{margin-top:10px; display:none}
    #status{margin-top:12px; text-align:center; font-size:14px; color:var(--muted)}
    #status.ok{color:var(--mint)}
    #status.err{color:#ff7b7b}
  </style>
</head>
<body>

  <!-- Header compartilhado -->
  <div id="site-header"></div>
  <script src="header.js" defer></script>

  <main id="conteudo">
    <!-- IMPORTANTE: adicionamos id e names para serializar corretamente -->
    <form class="card" id="leadForm">
      <h1 class="title">Vamos Escalar Juntos</h1>
      <p class="subtitle">Do primeiro contato à conversão: leve seu atendimento no WhatsApp para o próximo nível.</p>

      <div class="grid grid-2">
        <div class="field"><input class="input" name="firstName" placeholder="Nome" required></div>
        <div class="field"><input class="input" name="lastName" placeholder="Sobrenome" required></div>
        <div class="field"><input class="input" name="company" placeholder="Nome da empresa" required></div>
        <div class="field"><input class="input" name="segment" placeholder="Segmento de mercado"></div>
        <div class="field" style="grid-column:1/-1">
          <input type="tel" class="input" name="phone" placeholder="Telefone" required pattern="[0-9\s()+-]{8,}">
        </div>
      </div>

      <h3>Com o que podemos ajudar?</h3>
      <label class="choice">
        <input type="checkbox" name="help" value="Atendimento inicial automático — recepção e respostas rápidas no WhatsApp">
        <span>Atendimento inicial automático — recepção e respostas rápidas no WhatsApp</span>
      </label>
      <label class="choice">
        <input type="checkbox" name="help" value="Agendamento de horários — integração com agenda para marcações automáticas">
        <span>Agendamento de horários — integração com agenda para marcações automáticas.</span>
      </label>
      <label class="choice">
        <input type="checkbox" name="help" value="Suporte ao cliente — respostas inteligentes para dúvidas frequentes">
        <span>Suporte ao cliente — respostas inteligentes para dúvidas frequentes.</span>
      </label>
      <label class="choice">
        <input type="checkbox" name="help" value="Fluxos de atendimento personalizados — atendimento sob medida para o seu negócio">
        <span>Fluxos de atendimento personalizados — atendimento sob medida para o seu negócio.</span>
      </label>
      <label class="choice">
        <input type="checkbox" name="help" value="Automação de vendas — do primeiro contato até a conversão, direto no WhatsApp">
        <span>Automação de vendas — do primeiro contato até a conversão, direto no WhatsApp.</span>
      </label>
      <label class="choice">
        <input type="checkbox" id="otherCheck" name="help" value="Outro">
        <span>Outro</span>
      </label>

      <div class="field" id="otherField">
        <input class="input" type="text" id="otherText" name="otherDetail" placeholder="Descreva o Outro">
      </div>

      <textarea name="message" required placeholder="Descreva seu projeto: dados, volume, cronograma e resultados esperados"></textarea>

      <div class="field">
        <label><input type="checkbox" name="privacy" required> Eu concordo com a Política de Privacidade</label>
      </div>

      <!-- honeypot simples para bots -->
      <input type="text" name="website" autocomplete="off" tabindex="-1" style="position:absolute; left:-9999px; opacity:0" aria-hidden="true">

      <button class="btn" id="submitBtn" type="submit">Enviar</button>
      <p id="status" aria-live="polite"></p>
    </form>
  </main>

  <!-- Footer compartilhado -->
  <div id="site-footer"></div>
  <script src="footer.js" defer></script>

  <script>
    // ---- mostrar/ocultar campo "Outro" ----
    const otherCheck = document.getElementById('otherCheck');
    const otherField = document.getElementById('otherField');
    const otherText  = document.getElementById('otherText');

    otherField.style.display = 'none';
    otherText.disabled = true;

    otherCheck.addEventListener('change', () => {
      const on = otherCheck.checked;
      otherField.style.display = on ? 'block' : 'none';
      otherText.disabled = !on;
      if(on) otherText.focus(); else otherText.value = "";
    });

    // ---- envio ao Google Apps Script (JSON) ----
    const ENDPOINT = "https://script.google.com/macros/s/AKfycbw-SjEti8YbDE9vFvHalcKGdD4wnbpsGNfOQ5McwmTjwHHDYOtGFJSTeFXmj9r7Nz5IGw/exec";

    const form = document.getElementById('leadForm');
    const statusEl = document.getElementById('status');
    const submitBtn = document.getElementById('submitBtn');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // Honeypot: se preenchido, cancela
      if(form.website && form.website.value) {
        return; // silêncio para bots
      }

      // Coletar dados
      const fd = new FormData(form);
      const helps = fd.getAll('help'); // todas as checkboxes marcadas

      // Anexa detalhe de "Outro" quando marcado
      const otherDetail = (fd.get('otherDetail') || '').trim();
      const helpWithOther = helps.includes('Outro') && otherDetail
        ? helps.map(h => h === 'Outro' ? `Outro: ${otherDetail}` : h)
        : helps.filter(h => h !== 'Outro'); // remove "Outro" puro se sem detalhe

      const payload = {
        firstName: (fd.get('firstName') || '').trim(),
        lastName:  (fd.get('lastName')  || '').trim(),
        company:   (fd.get('company')   || '').trim(),
        segment:   (fd.get('segment')   || '').trim(),
        phone:     (fd.get('phone')     || '').trim(),
        help:      helpWithOther,
        message:   (fd.get('message')   || '').trim(),
        privacy:   !!fd.get('privacy'),
        source:    "site-vamos-escalar-juntos",
        userAgent: navigator.userAgent,
        page:      location.href,
        timestamp: new Date().toISOString()
      };

      // UX feedback
      statusEl.className = "";
      statusEl.textContent = "Enviando...";
      submitBtn.disabled = true;

      try {
        const res = await fetch(ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        // Alguns Apps Script retornam 200 com texto simples
        const text = await res.text();
        if(!res.ok) throw new Error(text || `HTTP ${res.status}`);

        statusEl.className = "ok";
        statusEl.textContent = "Recebido! Vamos falar com você em breve.";
        form.reset();
        otherField.style.display = 'none';
        otherText.disabled = true;
      } catch(err) {
        console.error(err);
        statusEl.className = "err";
        statusEl.textContent = "Não foi possível enviar agora. Tente novamente em instantes.";
      } finally {
        submitBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
